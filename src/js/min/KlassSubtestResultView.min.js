var KlassSubtestResultView,extend=function(t,e){function s(){this.constructor=t}for(var r in e)hasProp.call(e,r)&&(t[r]=e[r]);return s.prototype=e.prototype,t.prototype=new s,t.__super__=e.prototype,t},hasProp={}.hasOwnProperty;KlassSubtestResultView=function(e){function s(){return s.__super__.constructor.apply(this,arguments)}return extend(s,e),s.prototype.className="KlassSubtestResultView",s.prototype.events={"click .run":"checkRun","click .back":"back","click .show_itemized":"showItemized"},s.prototype.initialize=function(t){return this.allResults=t.allResults,this.results=t.results,this.result=this.results[0],this.previous=t.previous,this.subtest=t.subtest,this.student=t.student},s.prototype.gotoRun=function(){return Tangerine.router.navigate("class/run/"+this.options.student.id+"/"+this.options.subtest.id,!0)},s.prototype.checkRun=function(){var t,e,s,r;return(e=this.subtest.has("gridLinkId")&&""!==this.subtest.get("gridLinkId"))?(t=this.subtest.get("gridLinkId"),s=this.allResults.where({subtestId:t,studentId:this.student.id}),0===s.length?(r=new Subtest({_id:t}),void r.fetch({success:function(t){return function(){return Utils.midAlert("Please complete<br><b>"+r.escape("name")+"</b><br>for<br><b>"+t.student.escape("name")+"</b><br>before this test.",5e3)}}(this)})):this.gotoRun()):void this.gotoRun()},s.prototype.showItemized=function(){return this.$el.find(".itemized").fadeToggle()},s.prototype.back=function(){return Tangerine.router.navigate("class/"+this.options.student.get("klassId")+"/"+this.options.subtest.get("part"),!0)},s.prototype.render=function(){var e,s,r,i,n,u,o,l,a,d,h,b,c;if(null!=this.result){if(this.results=this.results[0],a="<button class='command show_itemized'>"+t("itemized results")+"</button><table class='itemized confirmation'><tbody><tr><th>Item</th><th>Result</th></tr>","grid"===this.subtest.get("prototype"))for(o=this.result.get("subtestData").items,r=i=0,u=o.length;u>i;r=++i)s=o[r],a+="<tr><td>"+s.itemLabel+"</td><td>"+t(s.itemResult)+"</td></tr>";else if("survey"===this.subtest.get("prototype")){l=this.result.get("subtestData");for(n in l)c=l[n],a+="<tr><td>"+n+"</td><td>"+t(c)+"</td></tr>"}a+="</tbody></table><br>",b=new Date(this.result.get("startTime")),this.previous>0&&(h="<tr> <td><label>Taken last</label></td><td>"+b.getFullYear()+"/"+(b.getMonth()+1)+"/"+b.getDate()+"</td> </tr> <tr> <td><label>Previous attempts</label></td><td>"+this.previous+"</td> </tr>")}return(null==this.result||"progress"!==("function"==typeof(e=this.result).get?e.get("reportType"):void 0))&&(d="<div class='menu_box'> <img src='images/icon_run.png' class='run clickable'> </div><br>"),this.$el.html("<h1>Result</h1> <table><tbody> <tr> <td><label>Assessment</label></td> <td>"+this.subtest.get("part")+"</td> </tr> <tr> <td><label>Student</label></td> <td>"+this.student.escape("name")+"</td> </tr> <tr> <td><label>Subtest</label></td> <td>"+this.subtest.escape("name")+"</td> </tr> "+(h||"")+" </tbody></table> "+(a||"")+" "+(d||"")+" <button class='navigation back'>Back</button>"),this.trigger("rendered")},s}(Backbone.View);