var UsersMenuView,extend=function(e,t){function r(){this.constructor=e}for(var n in t)hasProp.call(t,n)&&(e[n]=t[n]);return r.prototype=t.prototype,e.prototype=new r,e.__super__=t.prototype,e},hasProp={}.hasOwnProperty;UsersMenuView=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return extend(t,e),t.prototype.className="UsersMenuView",t.prototype.events={"click .admin":"selectAdmin","click .reader":"selectReader","click #add_admin":"addAdmin","click #remove_admin":"removeAdmin","click #add_reader":"addReader","click #remove_reader":"removeReader"},t.prototype.selectAdmin=function(e){return this.$el.find("#selected_admin").val($(e.target).attr("data-name"))},t.prototype.selectReader=function(e){return this.$el.find("#selected_reader").val($(e.target).attr("data-name"))},t.prototype.addAdmin=function(){var e;return e=this.$el.find("#selected_admin").val(),this.useRobbert("add_admin",e)},t.prototype.removeAdmin=function(){var e;return e=this.$el.find("#selected_admin").val(),this.useRobbert("remove_admin",e)},t.prototype.addReader=function(){var e;return e=this.$el.find("#selected_reader").val(),this.useRobbert("add_reader",e)},t.prototype.removeReader=function(){var e;return e=this.$el.find("#selected_reader").val(),this.useRobbert("remove_reader",e)},t.prototype.useRobbert=function(e,t){return Utils.passwordPrompt(function(r){return function(n){return Robbert.request({action:e,user:t,group:Tangerine.settings.get("groupName"),auth_u:Tangerine.user.get("name"),auth_p:n,success:function(e){return Utils.midAlert(e.message),Tangerine.user.fetch({success:function(){return r.render()}})},error:function(e){return Utils.midAlert("Server error\n\n"+e[1]+"\n"+e[2])}})}}(this))},t.prototype.initialize=function(){},t.prototype.render=function(){var e,t,r,n,a,i,d;return r=Tangerine.user.dbAdmins,d=Tangerine.user.dbReaders,t=function(){var t,n,a;for(a=[],t=0,n=r.length;n>t;t++)e=r[t],a.push("<li data-name='"+_.escape(e)+"' class='admin icon'>"+_.escape(e)+"</li>");return a}().join(""),i=d.length>0?function(){var e,t,r;for(r=[],e=0,t=d.length;t>e;e++)a=d[e],r.push("<li data-name='"+_.escape(a)+"' class='reader icon'>"+_.escape(a)+"</li>");return r}().join(""):"<span class='grey'>No members yet.</span>",n="<h1>Users</h1> <table> <tr> <th>Admins</th> <th>Members</th> </tr> <tr> <td> <input id='selected_admin'  value=''> <button id='add_admin' class='command'>+</button> <button id='remove_admin' class='command'>-</button> </td> <td> <input id='selected_reader' value=''> <button id='add_reader' class='command'>+</button> <button id='remove_reader' class='command'>-</button> </td> </tr> <tr> <td> <ul id='member_select' multiple='multiple' size='5'> "+t+" </ul> </td> <td> <ul id='reader_select' multiple='multiple' size='5'> "+i+" </ul> </td> </tr>",this.$el.html(n)},t}(Backbone.View);