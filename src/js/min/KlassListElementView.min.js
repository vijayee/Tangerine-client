var KlassListElementView,bind=function(e,t){return function(){return e.apply(t,arguments)}},extend=function(e,t){function r(){this.constructor=e}for(var n in t)hasProp.call(t,n)&&(e[n]=t[n]);return r.prototype=t.prototype,e.prototype=new r,e.__super__=t.prototype,e},hasProp={}.hasOwnProperty;KlassListElementView=function(e){function r(){return this.render=bind(this.render,this),r.__super__.constructor.apply(this,arguments)}return extend(r,e),r.prototype.className="KlassListElementView",r.prototype.tagName="li",r.prototype.events={"click .klass_run":"run","click .klass_results":"showReportSelect","change #report":"getReportMenu","click .cancel_report":"cancelReport","click .klass_edit":"edit","click .klass_delete":"toggleDelete","click .klass_delete_cancel":"toggleDelete","click .klass_delete_delete":"delete"},r.prototype.initialize=function(e){return this.availableReports=Tangerine.config.get("reports"),e.klass.has("curriculumId")?(this.curriculum=new Curriculum({_id:e.klass.get("curriculumId")}),this.curriculum.fetch({success:this.render})):this.curriculum=new Curriculum},r.prototype.edit=function(){return Tangerine.router.navigate("class/edit/"+this.options.klass.id,!0)},r.prototype.getReportMenu=function(e){var t;return null!=(t=this.subMenuView)&&t.close(),this.subMenuView=new(window[$(e.target).find(":selected").attr("data-menu_view")])({parent:this}),this.$el.find("#report_menu_container").append("<div class='report_menu'></div>"),this.subMenuView.setElement(this.$el.find("#report_menu_container .report_menu")),this.subMenuView.render()},r.prototype.showReportSelect=function(){return this.$el.find(".report_select_container").removeClass("confirmation")},r.prototype.cancelReport=function(){var e;return this.$el.find("div#report_menu").empty(),this.$el.find("#report :nth-child(1)").attr("selected","selected"),this.$el.find(".report_select_container").addClass("confirmation"),null!=(e=this.subMenuView)?e.close():void 0},r.prototype.onClose=function(){var e;return null!=(e=this.subMenuView)?e.close():void 0},r.prototype.run=function(){return Tangerine.router.navigate("class/"+this.options.klass.id,!0)},r.prototype.toggleDelete=function(){return this.$el.find(".klass_delete_confirm").toggle()},r.prototype["delete"]=function(){return this.options.klass.collection.get(this.options.klass).destroy()},r.prototype.render=function(){var e,r,n,i,s,o,l,c,a;for(n=this.options.klass,"admin"===n.get("teacherId")?a="admin":(c=vm.currentView.teachers.get(n.get("teacherId")),a=(null!=c?c.getEscapedString("name"):void 0)||""),Tangerine.user.isAdmin()&&(e="<tr><th>Teacher</th><td>"+a+"</td></tr>"),s="",o=this.availableReports,r=0,i=o.length;i>r;r++)l=o[r],(null==l.context||l.context===Tangerine.settings.get("context"))&&(s+="<option data-menu_view='"+l.menuView+"'>"+t(l.name)+"</option>");return this.$el.html("<table> "+(e||"")+" <tr><th>School name</th><td>"+n.getEscapedString("schoolName")+"</td></tr> <tr><th>School year</th><td>"+n.getString("year")+"</td></tr> <tr><th>"+t("grade")+"</th><td>"+n.getString("grade")+"</td></tr> <tr><th>"+t("stream")+"</th><td>"+n.getString("stream")+"</td></tr> <tr><th>"+t("curriculum")+"</th><td>"+this.curriculum.getEscapedString("name")+"</td></tr> </table> <img src='images/icon_run.png'     class='icon klass_run'> <img src='images/icon_results.png' class='icon klass_results'> <img src='images/icon_edit.png'    class='icon klass_edit'> <img src='images/icon_delete.png'  class='icon klass_delete'> <div class='report_select_container confirmation'> <div class='menu_box'> <select id='report'> <option selected='selected' disabled='disabled'>"+t("select report type")+"</option> "+s+" </select> </div> <div id='report_menu_container'></div> <button class='command cancel_report'>"+t("cancel")+"</button> </div> <div class='klass_delete_confirm confirmation'> <div class='menu_box'> "+t("confirm")+"<br> <button class='klass_delete_delete command_red'>"+t("delete")+"</button> <button class='klass_delete_cancel command'>"+t("cancel")+"</button> </div> </div>"),this.trigger("rendered")},r}(Backbone.View);